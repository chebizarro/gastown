# =============================================================================
# Gas Town â€” Development Overrides
# =============================================================================
#
# This file is automatically loaded by `docker compose up` and provides
# development-friendly defaults. For production, use:
#
#   docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d
#
# =============================================================================

services:
  deacon:
    # Rebuild from source on every `docker compose up --build`
    build:
      context: .
      dockerfile: Dockerfile
      args:
        VERSION: dev
        COMMIT: local
    # Mount source workspace for persistence
    volumes:
      - ${GT_HOME:-./rigs}/${GT_RIG:-gastown}:/gt/${GT_RIG:-gastown}
      - ${GT_SPOOL_DIR:-./runtime}/${GT_RIG:-gastown}:/gt/${GT_RIG:-gastown}/.runtime
    environment:
      # Development defaults
      GT_NOSTR_ENABLED: "1"
      GT_LOG_LEVEL: debug

  relay:
    # In dev, expose relay on a predictable port
    ports:
      - "7777:7000"
